<!DOCTYPE html>
<html lang="en-US" dir="ltr" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/include/layout}">
	<head>
		<title>ì•Œë¦¼</title>
	</head>
<body>
	<main class="main" id="top" layout:fragment="content">
		<div class="content">

			<!-- ì˜¤ëŠ˜ ì•Œë¦¼ -->
			<h5 class="text-body-emphasis mb-3">ì˜¤ëŠ˜</h5>
			<div class="mx-n4 mx-lg-n6 mb-5 border-bottom">
				<div th:each="alarm : ${calendaralarm}"
					th:if="${#temporals.format(alarm.alarm_reg_date, 'yyyy-MM-dd')} == ${#temporals.format(#temporals.createNow(), 'yyyy-MM-dd')}"
					class="d-flex align-items-center justify-content-between py-3 px-lg-6 px-4 notification-card border-top"
					th:classappend="${alarm.alarm_read_yn == 'N'} ? ' unread' : ' read'">

					<div class="d-flex">
						<div class="avatar avatar-xl me-3">
							<img class="rounded-circle"
								src="/assets/img/team/default-profile.webp" alt="">
						</div>
						<div class="me-3 flex-1 mt-2">
							<h4 class="fs-9 text-body-emphasis"
								th:text="${(alarm.separator != null and alarm.separator.startsWith('A')) ? 'íšŒì‚¬ ì¼ì • ê³µì§€' : 
              (alarm.separator != null and alarm.separator.startsWith('T')) ? 'íŒ€ ì¼ì • ê³µì§€' : 'ê¸°íƒ€ ê³µì§€'}">
							</h4>
							<p class="fs-9 text-body-highlight">
								<span class="me-2"><i
									class="fas fa-bullhorn text-primary"></i></span> <span
									class="fw-bold text-dark"
									th:text="${alarm.separator.startsWith('A') ? 'ğŸ§¾ ìƒˆë¡œìš´ íšŒì‚¬ ì¼ì • ë“±ë¡' : 'ğŸ‘¥ ìƒˆë¡œìš´ íŒ€ ì¼ì • ë“±ë¡'}">
								</span> <span
									class="ms-2 text-body-tertiary text-opacity-85 fw-bold fs-10 time-ago"
									th:attr="data-time=${#temporals.format(alarm.alarm_reg_date, 'yyyy-MM-dd''T''HH:mm:ss')}">
								</span>
							</p>
							<p class="text-body-secondary fs-9 mb-0">
								<i class="fas fa-clock me-1"></i> <span class="fw-bold"
									th:text="|${#temporals.format(alarm.alarm_reg_date, 'a h:mm')} / ${#temporals.format(alarm.alarm_reg_date, 'yyyy-MM-dd')}|">
								</span>
							</p>
						</div>
					</div>

					<div class="dropdown">
						<button
							class="btn fs-10 btn-sm dropdown-toggle dropdown-caret-none transition-none notification-dropdown-toggle"
							type="button" data-bs-toggle="dropdown" aria-haspopup="true"
							aria-expanded="false">
							<i class="fas fa-ellipsis-h fs-10 text-body"></i>
						</button>
						<div class="dropdown-menu dropdown-menu-end py-2">
							<a class="dropdown-item" href="#!">ì½ì§€ ì•ŠìŒìœ¼ë¡œ í‘œì‹œ</a>
						</div>
					</div>

				</div>
			</div>

			<!-- ì–´ì œ ì•Œë¦¼ -->
			<h5 class="text-semibold text-body-emphasis mb-3">ì–´ì œ</h5>
			<div class="mx-n4 mx-lg-n6 mb-9 border-bottom">
				<div th:each="alarm : ${calendaralarm}"
					th:if="${#temporals.format(alarm.alarm_reg_date, 'yyyy-MM-dd')} == ${#temporals.format(#temporals.createNow().minusDays(1), 'yyyy-MM-dd')}"
					class="d-flex align-items-center justify-content-between py-3 px-lg-6 px-4 notification-card border-top"
					th:classappend="${alarm.alarm_read_yn == 'N'} ? ' unread' : ' read'">

					<div class="d-flex">
						<div class="avatar avatar-xl me-3">
							<img class="rounded-circle"
								src="/assets/img/team/default-profile.webp" alt="">
						</div>
						<div class="me-3 flex-1 mt-2">
							<h4 class="fs-9 text-body-emphasis"
								th:text="${(alarm.separator != null and alarm.separator.startsWith('A')) ? 'íšŒì‚¬ ì¼ì • ê³µì§€' : 
              (alarm.separator != null and alarm.separator.startsWith('T')) ? 'íŒ€ ì¼ì • ê³µì§€' : 'ê¸°íƒ€ ê³µì§€'}">
							</h4>
							<p class="fs-9 text-body-highlight">
								<span class="me-2"><i
									class="fas fa-bullhorn text-primary"></i></span> <span
									class="fw-bold text-dark"
									th:text="${alarm.separator.startsWith('A') ? 'ğŸ§¾ ìƒˆë¡œìš´ íšŒì‚¬ ì¼ì • ë“±ë¡' : 'ğŸ‘¥ ìƒˆë¡œìš´ íŒ€ ì¼ì • ë“±ë¡'}">
								</span> <span
									class="ms-2 text-body-tertiary text-opacity-85 fw-bold fs-10 time-ago"
									th:attr="data-time=${#temporals.format(alarm.alarm_reg_date, 'yyyy-MM-dd''T''HH:mm:ss')}">
								</span>
							</p>
							<p class="text-body-secondary fs-9 mb-0">
								<i class="fas fa-clock me-1"></i> <span class="fw-bold"
									th:text="|${#temporals.format(alarm.alarm_reg_date, 'a h:mm')} / ${#temporals.format(alarm.alarm_reg_date, 'yyyy-MM-dd')}|">
								</span>
							</p>
						</div>
					</div>

					<div class="dropdown">
						<button
							class="btn fs-10 btn-sm dropdown-toggle dropdown-caret-none transition-none notification-dropdown-toggle"
							type="button" data-bs-toggle="dropdown" aria-haspopup="true"
							aria-expanded="false">
							<i class="fas fa-ellipsis-h fs-10 text-body"></i>
						</button>
						<div class="dropdown-menu dropdown-menu-end py-2">
							<a class="dropdown-item" href="#!">ì½ì§€ ì•ŠìŒìœ¼ë¡œ í‘œì‹œ</a>
						</div>
					</div>

				</div>
			</div>

		</div>

		<!-- ì‹œê°„ "ë°©ê¸ˆì „/1ì‹œê°„ì „" ìŠ¤í¬ë¦½íŠ¸ -->
		<script>
			document.addEventListener("DOMContentLoaded", function() {
				const timeElements = document.querySelectorAll('.time-ago');
				timeElements.forEach(function(el) {
					const timeString = el.getAttribute('data-time');
					const eventTime = new Date(timeString);
					const now = new Date();
					const diffMs = now - eventTime;
					const diffSec = Math.floor(diffMs / 1000);
					const diffMin = Math.floor(diffSec / 60);
					const diffHour = Math.floor(diffMin / 60);
					const diffDay = Math.floor(diffHour / 24);

					let displayText = '';

					if (diffSec < 60) {
						displayText = 'ë°©ê¸ˆ ì „';
					} else if (diffMin < 60) {
						displayText = diffMin + 'ë¶„ ì „';
					} else if (diffHour < 24) {
						displayText = diffHour + 'ì‹œê°„ ì „';
					} else if (diffDay === 1) {
						displayText = 'ì–´ì œ';
					} else {
						displayText = diffDay + 'ì¼ ì „';
					}

					el.textContent = displayText;
				});
			});
		</script>

	</main>
</body>
</html>
